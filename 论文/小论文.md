## 小论文

### 没有解决的问题

- 目标设定：车次数最少等价于单辆车的货物总重量最大                                                                                                                       

- 画图（几张图？）

- 转换为word格式（数学公式）



1. 在遗传算法的基础上，设计一个全新的算法，相关工作都列出来算法，及思路，遗传算法和帕累托算法结合设计的新的算法

2. 相关工作写到问题定义后面，没有可以完全应用的场景的代表性算法，不同方向的算法挑一个代表性算法（不止是遗传算法）为什么从遗传算法的角度来写。一定要写明为什么遗传算法，这是主要的方法。问题是np的，（参考文献证明），近似算法为什么用遗传算法，

   > 启发式算法是多目标优化问题现有研究中最常见的解决方案。由于NP问题一般的数学方法无法在有限时间内求解，因此采用启发式算法在可接受时间范围内得到待解决离散最优化问题的可行近似最优解，常用的算法主要有遗传算法、蚁群算法、模拟退火算法等。而遗传算法是模仿生物群落演化的过程，实现随着时间群组不断演化最后收敛的算法，其主要模仿的是自然中个体和基因繁殖、杂交和变异的现象，因此遗传算法的过程主要包括四个组成部分：初始种群的表示方式、优秀个体的选择、基因之间的交叉、基因自身的变异。
   >
   > 
   >
   > 遗传算法：处理离散问题，很好的处理约束问题，跳出局部最优得到全局最优解，全局搜索能力强；
   >
   > 模拟退火：局部搜索能力强，全局搜索能力差，容易受到参数的影响
   >
   > 爬山算法：简单、效率高，不适合处理大规模多约束问题
   >
   > 粒子群算法：容易陷入局部最优，不是全局收敛，适合求解实数问题
   >
   > 蚁群算法：参数设置复杂，参数设置不当，容易偏离优质解

3. 场景文字描述，分货过程有多个目标，再用数学语言写出来，

多目标在这个场景下没有工作，其他场景有类似的，已经证明是np问题，参考文献，第一类方法如何解决（思路）代表性的论文，什么场景用了这个方法，第二类、第三类。。

我选择遗传算法的原因，

- 算法框架：货物预处理，候选集，得到结果（遗传算法的框架）
- 求近似解的思路，
- 为什么这么设计？两大段文字？（700字design思路）



1. 模型
2. 算法框架+可以求出这个解（和其他算法比较，为什么要这么设计这个算法，结合相关工作和场景）
   - 能不能求准确解（用近似算法）
   - 为什么要选帕累托概念（别人的算法证明效果要好，可以体现目标之间的冲突，当前的场景适用这种方法，所以适用）
3. 收敛的速度很慢，对算法做优化（性能）
4. 或者结合2和3点，快速收敛（帕累托+遗传算法）的算法，将算法特点，np的，帕累托方法，做出决策的原因，存在收敛的问题，为了应对这些挑战，做的设计。
5. 遗传算法，权重的速度快，解的质量不高，帕累托的解质量高，速度慢，如何在保证解的质量的情况下加快迭代的速度。

### 摘要

> 200-400字
>
> 摘要应简明扼要，避免一般背景介绍，应包括研究目的，方法及过程，结果和结论这些要素，不要出现“本文”、“我们”之类词

针对多目标货物配载问题，建立了以最大化总订单货物重量、最小化车次总数、最小化货物装卸地总数为目标的配载数学模型，提出了一种快速收敛的基于精英策略多目标遗传算法（Fast convergence based on the elitism genetic algorithm(FEGA)）。首先在遗传算法的基础上加入Pareto支配关系上的分层结构和精英保留策略，从而提高种群多样性的同时可以加快算法的局部搜索能力；然后修改初始种群的随机结构，并加入双种群策略，添加自适应操作算子，依次提高算法的全局搜索能力，加速种群的收敛速度。基于新算法，利用真实的货物数据证明算法的可行性与优化效果。结果表明，与传统遗传算法相比，所提算法在求解强约束条件、庞大搜索空间的货物配载过程中具有较好的优化效果，搜索性能与收敛性都有所提升。

In order to solve the multi-objective cargo allocation problem with greater stability and efficiency, a mathematical model of cargo allocation with the objectives of maximizing the total order cargo weight, minimizing the total number of trips and minimizing the total number of cargo loading and unloading places is established, and a fast convergence based on the elitism genetic algorithm (FEGA) is proposed. algorithm (FEGA). Firstly, a hierarchical structure on the Pareto dominance relation and an elitism retention strategy are added on the basis of the genetic algorithm, thus improving the population diversity while the local search ability of the algorithm can be accelerated; then the random structure of the initial population is modified, and a double population strategy is added, and an adaptive operation operator is added to sequentially improve the global search ability of the algorithm and accelerate the convergence speed of the population. Based on the new algorithm, real cargo data are used to demonstrate the feasibility and optimization effect of the algorithm. The results show that compared with the traditional genetic algorithm, the proposed algorithm has a better optimization effect in solving the cargo allocation process with strong constraints and large search space, and the search performance and convergence are improved.

### 0 引言

随着钢铁物流行业的飞速发展，大宗货物的配载现已进入蓬勃发展的阶段，行业内的许多顽固问题也逐渐暴露。钢材运输具有长距离、运载重量过大的特点，只有重型卡车才能满足运载要求。但重型卡车的数量有限，且卡车分布不均匀，钢铁企业普遍面临着重卡超载、货物堆积、订单逾期等严重问题。传统的货物配载方案是由人工实时制定，基于最大化卡车负载来确定每辆卡车的货物配载方案，忽视了整体车辆的装载情况、司机对于运输任务的满意程度等其他信息，这些因素都与钢铁物流平台的利润息息相关。因此研究钢铁物流的配载问题，对降低物流平台运送成本、提高经济收益等都有着积极意义。

在实际的货物配载场景下，物流平台为了降低运送成本、提高经济收益，需要从货物特征、司机满意度等多个维度综合考虑，同时优化多个互相冲突和影响的目标，因此本文根据实际业务中的配载目标，建立货物配载多目标优化模型。

多目标优化问题根据用户偏好信息的决策时机分为先验和后验两类。其中先验方法是指在求解过程之前将偏好信息转化为显性的偏好因子，利用偏好因子将多目标标量化为单目标，最终转化为单目标优化问题，通过求解该单目标优化问题得到解。权重求和法[1]利用用户偏好信息为每个目标设定权重值，利用权重求和将多个目标标量化为单个目标最终求解最值得到最优解。字典法[2]通过解析用户的偏好信息将目标按照重要性进行排序，最终转化为求解一系列单目标形式的最优化问题。但是偏好因子的定性表示存在主观性，除非可以找到一个可靠而精确的偏好向量进行标量化，否则转化为单目标问题得到的解相当主观。当偏好因子无法被精确表示时，可以采用后验方法。后验方法首先找到多个目标的多重权衡下的最优解集，然后利用用户的偏好信息从多个解决方案中选择其中一个。大多数后验方法分为两类：基于数学规划的后验方法，该方法通过其中一个算法重复运行，每次运行该算法产生一个折衷解；进化算法则通过运行一次该算法可以产生一组折衷解。数学方法中法线边界相交（NBI）[3]，法线约束NC[4][5]，连续帕累托优化SPO[6]，定向搜索域DSD[7]方法通过构造若干标量来求解多目标问题，该标量化过程以获得均匀分布的折衷解为目标来构造的。但是多目标优化本身属于NP问题，当产生的折衷解数量过多，则需要更多的计算时间，在实际应用场景下该方法无法在有限的时间内产生足够的折衷解。进化算法[8]是目前产生多目标优化问题的折衷解最常用的方法，它可以在有限的时间内产生足够多的折衷解供决策者选择。其中NSGA-II[9]和NSGA-III[10]基于遗传算法提出帕累托最优解的概念，以及解与解之间的支配关系，通过支配关系将所有的可行解进行排序，进而提高算法的搜索效率。SPEA-II[11]在此基础上提出根据每个个体的支配个体数目和被支配个体数目来进一步计算适应度的值从而加快种群收敛。MOEA/D[12]基于分解的思想，将逼近整个帕累托前沿面的问题分解为一定数量的单目标优化问题，然后用进化算法同时求解这些单目标优化问题，同时可以保持个体的多样性。仿生类算法和仿物类算法如蚁群算法[13]、粒子群算法[14]、模拟退火算法[15]通过模拟生物和自然界物体的行为特征来设计种群的更新的方法。该类算法无法同时兼顾种群的多样性和收敛性，算法效率不高。物流领域中[16]综合了NSGA-II和基于生物地理学的优化算法来处理生产调度中的多目标车间作业调度问题，提高了算法的局部搜索能力的同时加快了种群的收敛速度。[17]构建的电网资源分配模型中，在预测模块中使用了神经网络，结合多目标优化算法SPEA，实现了经济成本、环境收益、能源利用率的多目标优化。

综上所述，并不存在适用所有场景的多目标方法，内部的随机优化结构需要根据具体的问题单独设计，而智能算法中粒子群算法更容易陷入局部最优，不适合求解离散问题。实际的货物装配问题带有强约束条件，模拟退火算法和爬山算法都不适用于大规模多约束问题，而遗传算法不仅可以很好得处理多约束条件下的离散问题，相较于其他智能算法，具有更强的全局搜索能力。

本文在对钢铁物流配载流程、特点和货物配载目标充分调研的基础上，建立了货物配载多目标优化模型，并针对该问题特点，设计了一种基于精英保留策略的改进遗传算法，为了进一步加快种群的全局搜索能力，进一步提出了一种可以快速收敛的基于精英策略的改进遗传算法，在提高最优解质量的同时，增强算法全局与局部搜索能力。通过实际的货物数据，说明FEGA在面对约束条件复杂、搜索空间大的多目标优化问题时，在计算效率、收敛性和多样性上都优于普通遗传算法。

### 1 多目标货物配载模型

#### 1.1 问题描述（研究动机）

​        物流平台每天在零点获取仓库的库存数据，结合货物的品种、仓库、规格等特征以及不同品种的货物之间拼货时需满足的限制条件，对客户订单进行拆分、组合，生成一批装车清单，并上传至平台供司机选择。当前平台使用的配载方法是通过顺序遍历货物列表，在符合业务规则的条件下，以最大化单辆车的货物重量为目标为车次分配货物。该方法没有考虑到后续的货物信息和剩余空车次数量，无法实现全局最优的货物分配，导致大量货物积压，部分单车货物重量远低于车辆载重上限。

​        针对上述货物配载效率太低及货车利用率不高等问题，本文提出了多目标优化货物配载模型，根据实际的业务调研结果，从物流平台和货车司机双方的角度考虑，设计以下3个具有实际应用价值的目标。从物流平台的角度考虑，通过增加单批次所有订单的货物总重量，减少单批次订单数即减少车次数来降低平台成本，与此同时在货车不超载的情况下尽可能增大单辆车的装载重量，从而在提高配载效率的同时可以提升平台经济收益；从货车司机的角度考虑，尽可能降低货车中货物的装卸地数量，可减少司机的时间成本，给司机带来最大的便利。同时这三个目标具有优先级，优先最大化所有订单的货物总重量，其次减少总订单数，减少总订单的货物装卸地优先级最低。

#### 1.2 数学模型

> - 三个目标方程及对应的解释说明
> - 约束条件及解释说明

1. 根据对货物配载问题的分析，货物配载模型主要参数如下：

   本文使用 $T_i(1\le i \le m)$ 表示可供使用的车次中第 $i$ 辆车；$C_j(1 \le j \le n)$表示当前库存可发运货物中第 $j$ 件货物；使用装车清单描述车辆依次运输任务需要装载的货物情况；$w_j$ 表示货物 $C_j$ 的重量，单位为吨；$l_i$ 表示车辆 T_i 的载重上限，单位为吨，并根据货物卸货地进行区分；$q_i$ 表示车辆 $T_i$ 上的货物装卸地数总和，可能的取值为2，3，4，每辆货车的装卸情况至少是一装一卸，最多两装两卸。

   模型的目标方程如下所示：
   $$
   \begin{cases}
   \begin{align}
   & maximize \ \ \ \ \ \ \  f_1 = \sum_{i=1}^m\sum_{j=1}^n w_jx_{ij}  \tag{1}\\ 
   & maximize \ \ \ \ \ \ \  f_2 = \sum_{j=1}^nw_jx_{ij} \tag{2}\\
   & minimize \ \ \ \ \ \ \  f_3 =  \sum_{i=1}^mq_i \tag{3}
                \\
   & subject \ \ to.\quad \ \sum_{j=1}^nw_jx_{ij} \leq l_i ,\quad i \in M = \left \{ 1, \cdots, m \right \} . \tag{4}\\
   & \ \quad \quad \quad \quad \quad \quad \sum_{i=1}^nx_{ij} \leq 1 , \quad j \in N = \left \{ 1, \cdots, n \right \} . \tag{5}\\
   & 其中 \ \quad\quad \quad\quad \ 
   x_{ij}=
   \begin{cases} 
   0,\quad 如果货物 j 没有被分配至货车 i \\
   1,\quad 如果货物 j 被分配至货车 i 
   \tag{6}
   \end{cases}
   \end{align}
   \end{cases}
   $$

   式（1）表示最大化总订单货物重量；

   式（2）表示最大化单辆车货物总重量；

   式（3）表示最小化货车货物装卸地数量；

   式中的 $x_{ij}$ 为0或者1，表示货物 $C_j$ 是否被分配至车辆 $T_i$ 中。

   约束条件：

   式（4）表示每辆车中装载的货物总重量不得超过货车的载重上限；

   式（5）表示每件货只能被放置一次，不可同时被放置在不同的车辆中。

### 2 Elitism genetic algorithm（EGA）算法求解多目标货物配载模型

> 1. 传统的遗传算法的缺点
>    - 实际问题中目标互相冲突，传统的遗传算法（适应度函数：单目标优化）没有体现多目标的竞争性
>      - 提出帕累托支配概念
>    - 约束条件过于复杂，无法找到可行解
>      - 提出精英保留策略
> 2. 每个修改的过程具体描述
> 3. xx算法的流程说明
> 4. 附上流程图（伪代码）

​        遗传算法是模仿生物群落演化的过程，实现随着时间群组不断演化最后收敛的算法，其主要模仿的是自然中个体和基因繁殖、杂交和变异的现象，因此遗传算法的过程主要包括四个组成部分：初始种群的表示方式、优秀个体的选择、基因之间的交叉、基因自身的变异。本文在对历史数据的统计与分析过程中发现，在实际的货物配载过程中，最大化总订单货物重量往往需要对多份货物进行拆分重新组合，与此同时，单份订单中的货物装卸地数量也随之增加，这表明配载过程中多个目标之间互相冲突，而传统的遗传算法并不能体现多个目标之间的冲突与竞争关系。遗传算法在进化过程选择个体时，普遍采用随机结构，但受制于配载过程中严格的约束条件，随机挑选的个体极有可能都不符合配载规则，导致种群进化过程中需要耗费大量的时间寻找第一代可行解，严重影响计算效率，而一旦种群在进化过程中产生了符合约束的个体，种群会提前进入收敛状态，导致最终得到的最优解质量较差。遗传算法本身依靠基因之间的交叉与变异这对相互配合又相互竞争的操作而使其具备兼顾全局和局部的均衡搜索能力，在复杂约束条件下，传统的交叉、变异方法可能会失去作用，交叉或变异操作都可能会破坏掉原本已有的优秀个体的基因结构，导致解的多样性不足，即便进入种群进化的中后期，最终解仍然有可能停留在找到第一代可行解的阶段。

针对以上问题，本文提出基于精英保留的遗传算法（Elitism-GA），主要在遗传算法（GA）的基础上进行了以下三个部分的优化：

1. 引入基于Pareto支配关系的分层结构。[参考文献]提出帕累托最优，[参考文献]提出帕累托支配关系，利用Pareto支配关系对个体进行分层，使得更优秀的个体基因以更大的概率被保留到下一代种群中。
2. 采用改进的精英保留策略。通过Pareto支配关系对个体进行分层后，保留父代种群中的非支配解，使其直接进入子代种群，避免父代中优秀个体的丢失。
3. 设计独立的交叉、变异算子。根据约束条件设计特殊的交叉、变异操作，提高算法局部搜索能力的同时加快种群收敛的速度。

#### 2.1 基于Pareto支配关系的分层结构

[帕累托]在1986年提出多目标优化问题中Pareto支配关系的概念，其定义为：假设任何二解S1及S2对所有目标而言，S1均优于S2，则称S1支配S2，若S1没有被其他解所支配，则S1称为非支配解（不受支配的解），也称为Pareto解，S2称为受支配解。在多目标优化问题中，如果目标之间存在冲突与竞争关系，会存在多个非支配解，此时一组目标函数最优解的表示形式为Pareto最优解集。

相关数学定义如下所示。

**定义1** （Pareto支配）设 x 和 y 是种群中任意两个个体，需满足如下约束条件，则称 x 支配 y，记作 $x \succ y$
$$
\begin{cases}
\begin{aligned}
f_i(x) \le f_i(y), \quad {\forall}i=1, 2, \dots, m \\
f_j(x) < f_j(y), \quad {\exists}j = 1, 2, \dots, m
\end{aligned}
\end{cases}
$$
**定义2**（非支配解） 设 x 是集合 Q 中的任意解，需满足式xx（下式用数字表示），则称x为集合Q中的非支配解
$$
{\nexists}y \in Q: y\succ x
$$
**定义3**（Pareto最优解）设可行域 R 中任意两个个体 x 与 y，需满足式xx，则称个体 x 为Pareto最优解
$$
{\nexists}y\in R: y\succ x
$$
**定义4**（Pareto最优解集）可行域R中所有的Pareto最优解组成Pareto最优解集（Pareto Set，PS）
$$
S = \lbrace x \mid x\in R \ \ \text{且} x \text{是} Pareto\text{最优解}\rbrace
$$
**定义5**（Pareto前沿）Pareto最优解集中所有Pareto最优解在目标空间上的映射，称为：Pareto前沿（Pareto Front，PF）
$$
PF = \lbrace f(x) \in R \mid x \in PS\rbrace
$$

将种群中的个体根据支配关系进行分层。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5C%E7%AE%97%E6%B3%95%E9%9D%9E%E6%94%AF%E9%85%8D%E5%88%86%E5%B1%82.png" alt="算法非支配分层" style="zoom:80%;" />

> step (1) 设 $j=1$;
>
> step (2) 对于所有的 $g=1,2,...,N$ 且 $g \neq j$ ，基于适应度函数比较个体 $x^j$ 和个体 $x^g$ 之间的支配与非支配关系；
>
> step (3) 如果不存在任何一个个体 $x^g$  优于 $x^j$ ，那么 $x^j$ 被标记为非支配个体；
>
> step (4) 令 $j = j+1$，重复步骤 (1)，直到找到所有的非支配个体

首次运行该分层算法可得到**第一级非支配层**；忽略这些非支配个体，重复该算法 ，得到**第二级非支配层**，以此类推，直到所有种群中的个体被分类。

#### 2.2 精英保留策略

[De Jong KA. Analysis of the behavior of a class of genetic adaptive systems. 1975.]提出精英保留策略，其核心思想是把种群进化过程中出现的精英个体复制到下一代中。但是传统精英策略存在保持种群多样性能力差、易于收敛于局部最优等问题，本文对其进行了改进：

1. 对各等级非支配层上的个体进行拥挤度排序；

2. 为了保留尽可能多的精英解，将位于1级非支配层上的所有个体直接选入子代，若其数量超过子代种群数量N的0.15倍，则按照拥挤度排序选择前0.15N个个体进入子代；

3. 对其他等级非支配层上的个体，由于选取的精英个体数量不超过种群总个体数量的30%，除第一层外个体数，剩余的名额平均分配给每一层非支配层。

   其中，，每级非支配层个体数量选择函数如下：
   $$
   N_i = 
   \begin{cases}
   \begin{aligned}
   & \mid F_1 \mid , \ i =1,  \ \mid F_1 \mid \le 0.15N \\
   & 0.15N, i=1,\  \mid F_1 \mid > 0.15N \\
   & \mid F_i \mid \cdot \frac{0.3N-\mid F_1 \mid}{I-1}, i \geq 2
   \end{aligned}
   \end{cases}
   $$


式中： i 表示非支配层等级；F_i表示第 i 级非支配层；N_i 表示从第 i 级非支配层 F_i 中选取的个体数量；$\mid F_i \mid$ 表示第 i 级非支配层上的个体数；N 表示种群大小；I 表示非支配层数

#### 2.3 交叉、变异操作

遗传算法的交叉、变异操作很大程度上决定了遗传算法进化的效率，迄今为止人们已经提出了许多种交叉、变异方法，如单点交叉、双点交叉、均匀交叉等交叉算子，单点变异、逆序变异等变异算子。这些交叉变异方法并不能很好的适应货物配问题中多约束的问题，导致大量的个体经过交叉变异过程之后不但没有进化，反而产生了大量的无效解（不符合约束条件的解），降低算法的搜索效率。

本文采用改进的基于位置的交叉（PBX）和基因串逆序变异方式，其中改进的PBX变异方法首先在两个父代染色体中随机选择几个不连续的位置，将父代染色体1这些位置上的基因复制到子代1相同位置上，再在父代染色体2上将子代1中缺少的基因按照顺序填入。另一个子代以类似方式得到。

改进的PBX交叉如图所示。基因串逆序变异方式如图所示。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5CPBX%E4%BA%A4%E5%8F%89.png" alt="PBX交叉" style="zoom:30%;" />

基因串逆序变异方式如图所示。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5C00I84HJN50JAO7CXI21C@PU.png" alt="img" style="zoom:30%;" />

#### 2.4 步骤流程

EGA算法的流程如下。

1. 设置迭代次数、交叉变异概率等初始化参数；
2. 随机生成包含N个个体的初始种群P_0作为第一代父种群P_t；
3. 对父代种群 Pt 进行非支配排序，对个体进行分层，得到各级Pareto非支配层 F1,F2,...,Fn；
4. 利用精英策略对父代种群 Pt 进行筛选，挑选出精英种群 Et，剩余个体即为非精英种群 NEt，其中精英种群作为子代种群 Qt1 直接进入下一代进化，非精英种群进行交叉、变异操作；
5. 利用特殊的交叉、变异算子对非精英种群 NEt 中的个体进行计算，生成子代种群Qt2，合并Qt2 和Qt1得到最终的子代种群Qt；
6. 判断迭代次数 g 是否达到最大，若是则跳转至下一步，否则迭代次数加一跳转至（2）进行下一轮循环。

EGA流程框架如图6所示。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5COQ9(G1$%60%7DGP%256JBP)S$00%7DB-1622202829925.png" alt="img" style="zoom:50%;" />

### 3 快速收敛的EGA设计

> 提出一个基本的算法框架，xx的遗传算法（新名字）
>
> 结合物流场景的优化。
>
> 求解帕累托最优解的算法框架（基本算法）前面还有筛选，快速收敛的xx算法，缺点，结合场景来谈，说服力。
>
> 结合场景定性的描述算法的缺点，基本的帕累托遗传算法的算法、优化的帕累托遗传算法，但是优缺点不能泛泛而谈，优点不用列，列缺点，基本的遗传算法缺点123，为什么场景下有这样的缺点，每一条是一段文字（200、300字），最后归纳为自己的改进。
>
> 收敛慢的原因，123分析原因，列出来，对应修改的方法，

相比于传统的遗传算法，上述改进的遗传算法在三个目标上的优化效果有显著提升，精英保留策略使得种群在进化过程中可以更快地找到第一批可行解，但算法内部仍采用随机结构，受制于严格的约束条件，随机结构并不适用于庞大的搜索空间，在一定程度上降低了算法的搜索效率。对遗传算法而言，个体的交叉、变异过程对解的质量，以及算法的效率都至关重要，自然环境中，不同的个体本身拥有不同的遗传能力，通过性别鉴定法[参考文献]，可以进一步为不同的个体提高区分度，进而改变其交叉、变异操作，使得最优解逼近真实Pareto前沿，同时提高算法的搜索效率。

为了加快种群的收敛速度，在保证解的多样性的同时使得算法可以更快得达到全局收敛状态，本文在基于精英保留策略遗传算法的基础上进行了以下三个部分的改进：

1. 修改种群初始化方法，不再使用随机结构生成全部的初始种群，采用贪心算法和随机结构相结合的方式，快速得到较好的初始解。
2. 引入双种群策略。根据是否符合约束条件将个体分为有效个体与无效个体，再根据性别鉴定法[参考文献]将有效个体分为繁殖能力强的繁殖个体和普通个体，对不同的个体采用不同的交叉、变异操作。
3. 采用自适应的交叉、变异算子。在种群进化前期设置高交叉概率，提高种群全局搜索能力，提高进化速度，后期设置高变异概率，防止陷入局部最优，提高局部搜索能力。

#### 3.1 种群初始化

传统的遗传算法利用随机结构生成作为初始父代种群，由于货物配载问题中的约束条件过于复杂，随机生成的个体会有极高的概率不符合约束条件而失效，降低了算法的收敛速度。在实际问题中，可以先利用贪心算法生成一部分装车清单，即符合约束条件的可行解，作为一部分初始种群（$P_{greedy}$），之后与随机生成的初始种群（$P_{random}$）合并为初始的父代种群，结合精英保留策略，这一部分可行解会成为初代精英解直接进入下一代的进化，直接加快了种群的收敛速度。两种方式的种群产生比例分别设置为0.3、0.7.

#### 3.2 双种群进化策略

多目标进化算法大都采用单一进化策略，在一定程度上降低了算法的搜索能力和收敛速度，增加了算法的随机性。采用双种群进化思想可以提高PDGA进化的方向性和适应性，扩大搜索空间，避免算法陷入局部最优的同时可以加快算法的收敛速度。在进化过程中，根据种群的比例参数和繁殖能力鉴定法将种群拆分为两个种群，并对两个种群采用不同的遗传操作。

其中性别鉴定法分为计算和评判染色体种群中个体繁殖能力两部分，具体流程如下。

1. 初始化参数：染色体种群规模N，测试种群规模S，种群分割比例参数 β；
2. 随机生成数量为S的测试种群；
3. 计算染色体种群中个体的繁殖能力；
4. 评判染色体种群中个体的繁殖能力；
5. 分割种群。选择繁殖个体中繁殖能力较大的N×β个个体形成子种群1，若数量不够，则挑选普通个体中繁殖能力较大的个体补充；剩余个体形成子种群2。

具体的算法流程如下所示。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5Cimage-20210528232713672.png" alt="image-20210528232713672" style="zoom:100%;" />

#### 3.3 自适应交叉、变异

遗传算法的参数中交叉概率和变异概率的选择是影响遗传算法行为和性能的关键所在，直接影响算法的收敛性。交叉概率越大，新个体产生的速度就越快，然而过大的交叉概率可能会破坏原本的个体基因结构，过小的交叉概率会降低搜索性能。对变异概率来说，过小的变异概率不易产生新的基因结构，过大的变异概率会导致遗产算法变成纯粹的随机搜索算法。

本文针对种群进化的不同阶段，使得交叉概率和变异概率能够自动改变。在种群进化前期，优秀个体距离Pareto最优前沿较远，为保证群体尽快找到支配解，采用较大的交叉概率 P_c，以提高全局搜索能力，加快种群进化过程；在种群进化中后期，种群中已有大部分优秀解，为放置算法陷入局部最优，采用较大的变异概率P_m，以提高局部搜索能力。

交叉概率范围设置为(0.4, 0.8)，变异概率范围设置为(0.01, 0.3)，自适应算子计算公式如下：
$$
P_c(i) = \min P_c + \frac{(\max P_c - \min P_c)(1+\cos(\pi \frac{i}{gen}))}{2}
$$

$$
P_m(i) = \min P_m + \frac{(\max P_m - \min P_m)(1 + \sin(\pi \frac{i}{gen}-\frac{\pi}{2}))}{2}
$$

其中 $P_c(i)$ 表示第 i 代的交叉概率；$P_m(i)$ 表示为第 i 代的变异概率；$gen$ 表示总迭代数；$\max P_c$ 表示最大交叉概率；$\min P_c$ 表示最小交叉概率；$\max P_m$ 表示最大变异概率；$\min P_m$ 表示最小变异概率。

#### 3.4 算法流程

FEGA算法流程描述如下。

1. 设置迭代次数、交叉变异概率等初始化参数；
2. 利用贪心算法生成0.3N个个体，再随机生成0.7N个个体，最后合并个体生成包含N个个体的初始种群P_0作为第一代父种群P_t；
3. 对父代种群 Pt 进行非支配排序，对个体进行分层，得到各级Pareto非支配层 F1,F2,...,Fn；
4. 通过繁殖能力鉴定法拆分种群，得到繁殖种群1和普通种群2；
5. 对种群1和种群2分别采用不同的自适应交叉、变异算子操作，得到子代种群；
6. 利用精英策略对子代种群进行筛选，挑选出精英种群，剩余个体即为非精英种群；
7. 合并双种群策略得到两份子代种群，得到新一代种群；
8. 判断迭代次数 g 是否达到最大，若是则跳转至下一步，否则迭代次数加一跳转至（3）进行下一轮循环。

流程图如下所示。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5C%E5%8F%8C%E7%A7%8D%E7%BE%A4%E7%B2%BE%E8%8B%B1%E7%AD%96%E7%95%A5%E4%B8%8B%E7%9A%84%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95.png" alt="双种群精英策略下的遗传算法" style="zoom:80%;" />

### 4 实验结果与分析

为验证FEGA算法求解的有效性，使用京创智汇物流平台提供的真实历史数据对所提算法进行性能测试，然后结合三个优化目标验证算法的实用性，同时对结果进行可视化。

#### 4.1 参数设置

实验在Windows10环境下运行，采用Python3.7语言编写，在为AMD Ryzen 7 4800U处理器和16GB RAM的机器上进行测试验证。在该实验中，参数设置如下：种群规模 N = 100，最大迭代次数 G = 1000，交叉概率范围（0.4，0.8），变异概率范围（0.01，0.3）。

#### 4.2 评价指标

**（1）非支配解数量**[参考文献]

非支配解的数量表示不被其他解占优的解集合大小，其定义如下。
$$
N_n = \mid S -\lbrace x \in S \mid \exist y \in S^*:y \succ x \rbrace \mid
$$
$S^*$ 表示所有非支配解的集合，显然 $N_n$ 的值越大，说明得到的解越好。

**（2）HV(Hypervolume)**[参考文献]

hypervolume为一个关于非支配解的离散度、收敛性的综合指标，因其已成为近年来多目标评价指标中最常用的指标之一。该指标计算时需要一个参考点，一般设置为真实帕累托前沿中每个目标的最大值，假设为 $R = (R_1, ..., R_m)^T$ ，HV 值越大，说明得到的解越好。

计算公式如下。其中Leb(A) 是集合 A 的 lebesgue测度。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5CHV%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87.png" alt="HV评价指标" style="zoom:80%;" />

#### 4.3 结果及分析

> 对比NSGA-II和改进的NSGA-II方法，和其他不是帕累托的方法进行比较。都是帕累托解的方法，比较迭代次数，两个指标（写出来计算方法，各个指标的值比较）不是帕累托的方法，得到的解

三个目标对应的最大值、Pareto解的个数、耗时

> 选择的算法：SOGA（单目标）、NSGA-II、EGA、Fast-EGA、MOPSO
>
> 1. 三个优化目标对应的五个方法的结果（有效性）
> 2. HV、IGD两个指标
> 3. 算法收敛性对比（SOGA、EGA、Fast-EGA）

##### 4.2.1 算法可行性分析

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5CHV%E5%AF%B9%E6%AF%94.png" alt="HV对比" style="zoom:80%;" />

从图中可看出EGA的收敛状况来回波动，稳定性较差，而FEGA的收敛状态相对稳定，且优于NSGA-II算法，通过设计混合贪心算法和随机结构生成初始种群极大地加快了种群的全局搜索能力，同时自适应操作算子双种群策略使得FEGA在货物配载过程中可以更快的收敛。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5C%E9%9D%9E%E6%94%AF%E9%85%8D%E8%A7%A3%E6%95%B0%E9%87%8F-1622250341002.png" alt="非支配解数量" style="zoom:80%;" />

图中显示最终EGA相对于NSGA-II的非支配解数量和相同，但达到收敛的速度优于NSGA-II，而FEGA无论是最终非支配解的数量还是达到收敛的速度都明显优于其他算法，表明FEGA在保持高求解精度的同时还具有快速收敛的性能，具有很好的全局、局部搜索能力。

##### 4.2.2 多个目标优化结果对比

为了验证快速收敛的精英遗传算法（FEGA）对多目标货物配载模型求解的有效性，将运行结果与传统的遗传算法、快速非支配排序遗传算法、粒子群算法的结果进行对比。对比结果如下表所示。

<img src="D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5C%E5%90%84%E7%AE%97%E6%B3%95%E7%9B%AE%E6%A0%87%E4%BC%98%E5%8C%96%E6%95%88%E6%9E%9C-1622236938096.png" alt="各算法目标优化效果" style="zoom:80%;" />

从表1可以看出：相对于传统的遗传算法而言，两种算法都取得了较好的测试结果，但随着问题规模的增加，FEGA算法的最优解在第一个目标上的结果明显优于其他算法，实际货物配载场景中，第一个目标的优先级最高，第二个目标的优先级次之，第三个目标的优先级最低。故相较于基础的遗传算法，本文提出的两种算法都可以实现货物配载的多目标优化。

##### 4.2.3 收敛性比较

![收敛速度对比](D:%5CUsers%5CYP%5Cgithub%5Cpaper_notes%5C%E8%AE%BA%E6%96%87%5C%E6%94%B6%E6%95%9B%E9%80%9F%E5%BA%A6%E5%AF%B9%E6%AF%94-1622229599276.png)

从图中收敛速度曲线对比分析可知，相比于其他算法，FEGA算法在采用双种群进化策略之后，不仅可以产生质量更高的最优解，算法的收敛速度也明显提升。EGA算法引入精英保留策略，相较于普通的遗传算法可以找到质量更好的解，同时其收敛速度比NSGA-II算法更快。验证了FEGA算法能够有效改善基础遗传算法的搜索性能和提升EGA算法的收敛性能。



### 5 结束语

本文根据物流平台需求建立货物配载多目标优化模型，对传统遗传算法的全局搜索能力与种群收敛速度进行优化，提出了带精英策略和自适应算子的双种群策略的改进遗传算法——FEGA算法，该算法在确保种群多样性的同时，增加算法全局搜索能力，加快种群收敛速度。以真实的货物数据集验证了算法求解多目标货物配载过程的可行性和有效性，证明了该算法在强约束条件和庞大的搜索空间的情况下获得最佳配载方案。
